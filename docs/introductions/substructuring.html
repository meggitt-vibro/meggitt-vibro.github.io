<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Substructuring – Joshua Meggitt</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../introductions/blockedForce.html" rel="next">
<link href="../introductions/isolators.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-045f01e90fa491bba6c51fbe92305c42.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Joshua Meggitt</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../introductions/introductions.html" aria-current="page"> 
<span class="menu-text">A quick introduction to:</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../papers/papers.html"> 
<span class="menu-text">Papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../book.html"> 
<span class="menu-text">Book</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="../mlsd.html">
 <span class="dropdown-text">Microphone and Loudspeaker Design</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../poav.html">
 <span class="dropdown-text">Principles of Acoustics and Vibration</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../introductions/substructuring.html">Substructuring</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/introductions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/VAVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vibro-Acoustic Virtual Prototyping</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/components.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Components (passive characterisation)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/interfaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface representations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/isolators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vibration isolators</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/substructuring.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Substructuring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/blockedForce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blocked forces</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Uncertainty</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#coupling-conditions" id="toc-coupling-conditions" class="nav-link active" data-scroll-target="#coupling-conditions">Coupling conditions</a></li>
  <li><a href="#direct-method-impedance-coupling" id="toc-direct-method-impedance-coupling" class="nav-link" data-scroll-target="#direct-method-impedance-coupling">Direct method (impedance coupling)</a></li>
  <li><a href="#three-field-formulation" id="toc-three-field-formulation" class="nav-link" data-scroll-target="#three-field-formulation">Three field formulation</a>
  <ul class="collapse">
  <li><a href="#primal" id="toc-primal" class="nav-link" data-scroll-target="#primal">Primal</a></li>
  <li><a href="#dual" id="toc-dual" class="nav-link" data-scroll-target="#dual">Dual</a></li>
  <li><a href="#including-resilient-coupling" id="toc-including-resilient-coupling" class="nav-link" data-scroll-target="#including-resilient-coupling">Including resilient coupling</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Substructuring</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>On this page we introduce substructuring; the process of mathematically coupling individual component models to build a model of an assembled system. Substructuring is a very broad subject, and can be performed in of the typical domains (physical, state space, modal, time and frequency). In <a href="../introductions/components.html">Components</a> we justified our choice of the frequency domain for the VAVP framework, and so representation of components by multi-DoF FRF matrices. For this reason, we will focus exclusively on frequency-based substructuring. Even then, there are various ways one can formulate the substructuring equations. We will breifly introduce the direct method before focusing on the primal and dual formulations, the atter of which tends to be the most commonly adopted in the literature.</p>
<section id="coupling-conditions" class="level2">
<h2 class="anchored" data-anchor-id="coupling-conditions">Coupling conditions</h2>
<p>The rigid coupling of two components requires satisfying two conditions: equilibrium and continuity.</p>
<div style="float: right; margin: 10px;">
<div id="fig-AIB" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-AIB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="subStructConds.png" class="img-fluid figure-img" width="300">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-AIB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Conditions of continuity and equilibrium.
</figcaption>
</figure>
</div>
</div>
<p>The condition of equilibrium is simply a restatement of Newton’s 3rd law - when two objects are in contact they exert equal and opposite forces on one another. For two sub-structures in rigid contact at a single point it may be expressed in the form, <span class="math display">\[
g_1 = -g_2
\]</span> where <span class="math inline">\(g_1\)</span> and <span class="math inline">\(g_2\)</span> represent the interface coupling forces at the connecting DoFs of the two sub-structures.</p>
<p>The condition of continuity (also known as compatibility) states that the sub-structural DoFs in rigid contact must move in unison, i.e.&nbsp;with equal velocity (also displacement and acceleration), and may be expressed in the form, <span class="math display">\[
v_1 = v_2 = v_C
\]</span> where <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span> represent the contact velocities of the two sub-structures, and <span class="math inline">\(v_C\)</span> the velocity of the coupled structure.</p>
<p>In the presence of several sub-structures and/or connecting DoFs, the above conditions can be expressed more generally in vector form as, <span id="eq-equil"><span class="math display">\[
\mathbf{g}_1 = -\mathbf{g}_2
\tag{1}\]</span></span> and <span id="eq-contin"><span class="math display">\[
\mathbf{v}_1 = \mathbf{v}_2 = \mathbf{v}_C
\tag{2}\]</span></span> where <a href="#eq-equil" class="quarto-xref">Equation&nbsp;1</a> and <a href="#eq-contin" class="quarto-xref">Equation&nbsp;2</a> are now generalised in the sense that they can also include moment forces and angular responses, respectively.</p>
<p>Dynamic substructuring, the process of assembling substructural properties to form an assembly, amounts to the application of the above conditions to the connecting interfaces between each substructure (or equivalently, component). Depending on how these substructures are represented (i.e.&nbsp;in the physical domain, modal domain, frequency domain, or state-space) the sub-structuring formulation may differ, though the underlying physics remains the same.</p>
<p>In this book we are principally focused on frequency domain methods, and so we will consider sub-structuring methods. That said, the sub-structuring methods presented below are not limited to experimental FRFs. FRF matrices determined by analytical or numerical means can also be used to represent individual sub-structures. In-fact, the ability to combine experimental and numerical sub-structures to form `hybrid assemblies’ is one of the principal advantages of the component-based approach to simulation.</p>
</section>
<section id="direct-method-impedance-coupling" class="level2">
<h2 class="anchored" data-anchor-id="direct-method-impedance-coupling">Direct method (impedance coupling)</h2>
<p>The direct formulation considers the special case in which just two substructures are being coupled, typically a source <span class="math inline">\(S\)</span> and receiver <span class="math inline">\(R\)</span> as in <a href="#fig-sourceRecDoFs" class="quarto-xref">Figure&nbsp;2</a>. Each substructure is characterised independently by their free interface mobility matrices, <span class="math inline">\(\mathbf{Y}_{Scc}\in\mathbb{C}^{N_c\times N_c}\)</span> and <span class="math inline">\(\mathbf{Y}_{Rcc}\in\mathbb{C}^{N_c\times N_c}\)</span>. If remote DoFs are considered on the receiver structure the transfer mobility <span class="math inline">\(\mathbf{Y}_{Rrc}\in\mathbb{C}^{N_r\times N_c}\)</span> (or the vibro-acoustic FRF <span class="math inline">\(\mathbf{H}_{Rrc}\in\mathbb{C}^{N_r\times N_c}\)</span>, if the sound pressure response is of interest) is also necessary. Our treatment of the direct method will be brief as the primal and dual methods provide far more flexible substructuring frameworks. Indeed, our focus here will simply be to prove the impedance coupling relation used in <a href="../introductions/isolators.html">Isolators</a> for the in situ characterisation of coupling element, i.e. <span id="eq-directSS1"><span class="math display">\[
\mathbf{Z}_{Ccc}  = \mathbf{Z}_{Acc} + \mathbf{Z}_{Icc} +   \mathbf{Z}_{Bcc}
\tag{3}\]</span></span> which states that when two structures are in rigid contact, their impedance matrices sum together.</p>
<div id="fig-sourceRecDoFs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sourceRecDoFs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sourceRecDoFs.png" class="img-fluid figure-img" width="500">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sourceRecDoFs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Illustration of example source-receiver (<span class="math inline">\(SR\)</span>) assembyly (shown uncoupled). Interface DoFs are denoted <span class="math inline">\(c\)</span> and remote points <span class="math inline">\(r\)</span>.
</figcaption>
</figure>
</div>
<p>To derive <a href="#eq-directSS1" class="quarto-xref">Equation&nbsp;3</a> we begin with the interface responses of the (uncoupled) substructures <span class="math inline">\(S\)</span> and <span class="math inline">\(R\)</span> due to an interface forcing, <span class="math display">\[
\mathbf{v}_{Sc} = \mathbf{Y}_{Scc} \left(\mathbf{f}_{Sc}+\mathbf{g}_{Sc}\right), \quad \mathbf{v}_{Rc} = \mathbf{Y}_{Rcc} \left(\mathbf{f}_{Rc}+\mathbf{g}_{Rc}\right)
\]</span> where <span class="math inline">\(\mathbf{f}\)</span> represents an externally applied force, and <span class="math inline">\(\mathbf{g}\)</span> a set of interface (coupling) forces.</p>
<p>We assume the inverse matrices <span class="math inline">\(\mathbf{Y}_{Scc}^{-1}\)</span> and <span class="math inline">\(\mathbf{Y}_{Rcc}^{-1}\)</span> exist, and rearrange the above equations to isolate the interface forces, <span class="math display">\[
\mathbf{Y}_{Scc}^{-1}\mathbf{v}_{Sc} - \mathbf{f}_{Sc} = \mathbf{g}_{Sc}, \quad \mathbf{Y}_{Rcc}^{-1}\mathbf{v}_{Rc} - \mathbf{f}_{Rc} = \mathbf{g}_{Rc}.
\]</span> Equilibrium and continuity are then enforced as per <a href="#eq-equil" class="quarto-xref">Equation&nbsp;1</a> and <strong>?@eq-eq-contin</strong>, <span class="math display">\[
\mathbf{Y}_{Scc}^{-1}\mathbf{v}_{c} - \mathbf{f}_{Sc} = -\mathbf{Y}_{Rcc}^{-1}\mathbf{v}_{c} + \mathbf{f}_{Rc}
\]</span> where it is noted that the coupled response <span class="math inline">\(\mathbf{v}_{c}\)</span> has been substituted for both the source and receiver velocities.</p>
<p>Isolating the external force terms and introducing the coupled external force <span class="math inline">\(\mathbf{f}_{c} = \mathbf{f}_{Rc} + \mathbf{f}_{Sc}\)</span> as the sum of substructure external forces yields, <span class="math display">\[
\left(\mathbf{Y}_{Scc}^{-1}+\mathbf{Y}_{Rcc}^{-1}\right)\mathbf{v}_{c} = \mathbf{f}_{c}.
\]</span> Finally, pre-multiplying both sides by the inverse of the left bracketed term (assuming its exists), we obtain an expression for the coupled velocity, <span id="eq-directPoint1"><span class="math display">\[
\mathbf{v}_{c} = \left(\mathbf{Y}_{Scc}^{-1}+\mathbf{Y}_{Rcc}^{-1}\right)^{-1} \mathbf{f}_{c}.
\tag{4}\]</span></span> <a href="#eq-directPoint1" class="quarto-xref">Equation&nbsp;4</a> relates an external force applied to the interface DoFs <span class="math inline">\(c\)</span> to the coupled velocity at said DoFs. Hence, the bracketed term must represent the point mobility matrix of the coupled assembly’s interface,<br>
<span id="eq-directPoint"><span class="math display">\[
\mathbf{Y}_{Ccc} = \left(\mathbf{Y}_{Scc}^{-1}+\mathbf{Y}_{Rcc}^{-1}\right)^{-1}.
\tag{5}\]</span></span> Recalling that the inverse of mobility is impedance, from <a href="#eq-directPoint" class="quarto-xref">Equation&nbsp;5</a> we see that the coupled impedance may be expressed simply as the sum of sub-structure impedances, <span class="math display">\[\label{}
\mathbf{Z}_{Ccc} = \mathbf{Z}_{Scc}+\mathbf{Z}_{Rcc}.
\]</span> This is a well known but important result; <em>when two structural components are in rigid contact, the impedance at their connection point is equal to the matrix sum of their respective impedances.</em> This result was used in <a href="../introductions/isolators.html">Isolators</a> to justify the in situ characterisation of resilient elements, but at the time was not proven.</p>
<p>Although perfectly admissible, <a href="#eq-directPoint" class="quarto-xref">Equation&nbsp;5</a> can be written in a more convenient (at least computationally) form using the mathematical relation, <span class="math display">\[\begin{align}\label{invSum}
\mathbf{Y}_{Scc}^{-1}+\mathbf{Y}_{Rcc}^{-1}  =  \mathbf{Y}_{Rcc}^{-1}\left[\mathbf{Y}_{Scc}+\mathbf{Y}_{Rcc}\right]\mathbf{Y}_{Scc}^{-1}.
\end{align}\]</span> Substitution into <a href="#eq-directPoint" class="quarto-xref">Equation&nbsp;5</a> then yields, <span class="math display">\[\begin{align}\label{directPointMob}
% \left(\mathbf{Y}_{Scc}^{-1}+\mathbf{Y}_{Rcc}^{-1}\right)^{-1}  &amp;=  \left(\mathbf{Y}_{Scc}^{-1}\left[\mathbf{Y}_{Rcc}+\mathbf{Y}_{Scc}\right]\mathbf{Y}_{Rcc}^{-1}\right)^{-1} \\
\mathbf{Y}_{Ccc} =\mathbf{Y}_{Scc}\left[\mathbf{Y}_{Scc}+\mathbf{Y}_{Rcc}\right]^{{-1}}\mathbf{Y}_{Rcc}.
\end{align}\]</span> In this modified form, the double matrix inversion is avoided. Matrix inversions are not only computationally expensive, but are known to cause an ‘amplification’ of errors and thus increase overall levels of uncertainty</p>
<p>Similar <em>direct</em> relations can be derived for the transfer FRF <span class="math inline">\(\mathbf{Y}_{Crc}\)</span> for rigid and resiliently sources components. However, this direct approach quickly becomes inconvenient as soon as any more components are introduced. Hence, we move on to discus the so-called <em>three field formulation</em> and the resulting primal and dual formulations.</p>
</section>
<section id="three-field-formulation" class="level2">
<h2 class="anchored" data-anchor-id="three-field-formulation">Three field formulation</h2>
<p>We begin by considering the equations of motion of <span class="math inline">\(P\)</span> sub-structures in a block diagonal form, as given by, <span id="eq-3F1"><span class="math display">\[
\mathbf{Z}\mathbf{v} = \mathbf{f} + \mathbf{g}
\tag{6}\]</span></span> where, <span class="math inline">\(\mathbf{Z}\)</span> is the block diagonal impedance matrix of the <span class="math inline">\(P\)</span> uncoupled sub-structures and <span class="math inline">\(\mathbf{v}\)</span>, <span class="math inline">\(\mathbf{f}\)</span> and <span class="math inline">\(\mathbf{g}\)</span> are the corresponding partitioned column vectors of velocities, applied forces, and coupling interface forces, respectively. <span class="math display">\[
\mathbf{Z} = \left[\begin{array}{c c c c}
\mathbf{Z}^{(1)} &amp; &amp; &amp;\\
&amp;  \mathbf{Z}^{(2)} &amp; &amp;\\
&amp; &amp; \mathbf{\ddots} &amp;\\
&amp; &amp; &amp; \mathbf{Z}^{(P)}
\end{array}\right]
\]</span></p>
<p><span class="math display">\[
\mathbf{v} = \left(\begin{array}{c}
\mathbf{v}^{(1)} \\
\mathbf{v}^{(2)}  \\
\vdots  \\
\mathbf{v}^{(P)}  
\end{array}\right),\quad \mathbf{f} = \left(\begin{array}{c}
\mathbf{f}^{(1)} \\
\mathbf{f}^{(2)}  \\
\vdots  \\
\mathbf{f}^{(P)}  
\end{array}\right),
\quad \mathbf{g} = \left(\begin{array}{c}
\mathbf{g}^{(1)} \\
\mathbf{g}^{(2)}  \\
\vdots  \\
\mathbf{g}^{(P)}  
\end{array}\right).
\]</span> Note that the vibro-acoustic FRF matrix <span class="math inline">\(\mathbf{H}\)</span> may be included straightforwardly by augmenting the appropriate impedance matrix.</p>
<div id="fig-SSexamp" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SSexamp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SRuc_cicj.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Uncoupled assembly.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SRc_cicj.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Coupled assembly</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SSexamp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Substructuring example with remote source (<span class="math inline">\(a\)</span>) and receiver (<span class="math inline">\(r\)</span>) DoFs. Coupling occurs at the interface DoFs, labelled <span class="math inline">\(1, \, 2, \, 3\)</span> and <span class="math inline">\(4\)</span>.
</figcaption>
</figure>
</div>
<p>As in the direct formulation, to assemble the individual substructures we must enforce the conditions of equilibrium and continuity. To do so we express <a href="#eq-equil" class="quarto-xref">Equation&nbsp;1</a> and <a href="#eq-contin" class="quarto-xref">Equation&nbsp;2</a> more generally in the form, <span id="eq-3F2"><span class="math display">\[
\mathbf{B}\mathbf{v} = \mathbf{0},
\tag{7}\]</span></span> and <span id="eq-3F3"><span class="math display">\[
\mathbf{L}^{\rm T}\mathbf{g} = \mathbf{0},
\tag{8}\]</span></span> respectively, where <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{L}\)</span> represent signed (contain only 0s, 1s and -1s) and unsigned (contain only (0s and 1s) Boolean matrices, respectively. Together, <a href="#eq-3F1" class="quarto-xref">Equation&nbsp;6</a> - <a href="#eq-3F3" class="quarto-xref">Equation&nbsp;8</a> are referred to as the three field formulation. They may be solved in a primal or dual manner, depending on whether <a href="#eq-3F2" class="quarto-xref">Equation&nbsp;7</a> or <a href="#eq-3F3" class="quarto-xref">Equation&nbsp;8</a> is satisfied <em>a priori</em>.</p>
<p>For the demonstrative example in <a href="#fig-SSexamp" class="quarto-xref">Figure&nbsp;3</a>, <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{L}^{\rm T}\)</span> are shown in <a href="#fig-SSexBL" class="quarto-xref">Figure&nbsp;4</a>.</p>
<div id="fig-SSexBL" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SSexBL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="subStruct_eqB.png" class="img-fluid figure-img" style="padding-top: 30px"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="subStruct_eqL.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SSexBL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Boolean coupling matrices for example problem in <a href="#fig-SSexamp" class="quarto-xref">Figure&nbsp;3</a>.
</figcaption>
</figure>
</div>
<p>Note that for both <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{L}^{\rm T}\)</span> the matrix columns correspond to the uncoupled DoFs of the assembly. For <span class="math inline">\(\mathbf{B}\)</span>, the rows correspond to the interface DoFs where coupling occurs, and for <span class="math inline">\(\mathbf{L}^{\rm T}\)</span> the coupled DoFs of the assembly. Their substitution into <a href="#eq-3F2" class="quarto-xref">Equation&nbsp;7</a> and <a href="#eq-3F3" class="quarto-xref">Equation&nbsp;8</a> yields, <span class="math display">\[
\left[\begin{array}{c c c c c c}
0 &amp; 1 &amp; 0 &amp; -1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; -1 &amp; 0 \\
\end{array}\right] \left(\begin{array}{c}
v_a\\v_{1}\\v_{2} \\ v_{3} \\v_{4} \\ v_b
\end{array}\right) = \left(\begin{array}{c}
0 \\ 0
\end{array}\right)
\]</span> and <span class="math display">\[
\left[\begin{array}{c c c c c c}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{array}\right]\left(\begin{array}{c}
0\\ g_{1}\\g_{2} \\ g_{3} \\g_{4} \\ 0
\end{array}\right) = \left(\begin{array}{c}
0\\0 \\ 0 \\0
\end{array}\right)
\]</span> which clearly satisfy the required constraints for rigid coupling.</p>
<p>From the above example we can see that to construct a signed Boolean matrix <span class="math inline">\(\mathbf{B}\)</span>, for each connection (i.e.&nbsp;row of <span class="math inline">\(\mathbf{B}\)</span>), we assign a 1 and -1 to the columns corresponding to the DoFs to be coupled. The size of <span class="math inline">\(\mathbf{B}\)</span> is such that the number of rows is equal to the number of connection points, and the number of columns to the number of uncoupled DoFs.</p>
<p>To construct the unsigned Boolean matrix <span class="math inline">\(\mathbf{L}^{\rm T}\)</span>, for each coupled interface DoF, a pair of 1s are placed in the columns corresponding uncoupled DoF. If a DoF is to be left uncoupled, a 1 is placed in the corresponding column. The size of <span class="math inline">\(\mathbf{L}^{\rm T}\)</span> is such that the number of rows is equal to the number of coupled DoFs, and the number of columns to the number of uncoupled DoFs.</p>
<section id="primal" class="level3">
<h3 class="anchored" data-anchor-id="primal">Primal</h3>
<p>The primal formulation begins by defining a unique set of DoFs <span class="math inline">\(\mathbf{v}_C\)</span> representing the <em>coupled</em> assembly. Note that number of coupled DoFs is always less than the number of uncoupled DoFs; for every pair of DoFs that we couple we reduced by one the total number of coupled DoFs, see for example <a href="#fig-SSexamp" class="quarto-xref">Figure&nbsp;3</a>. As per the condition of continuity, the coupled velocity <span class="math inline">\(\mathbf{v}_C\)</span> can be related to the uncoupled velocity <span class="math inline">\(\mathbf{v}\)</span> by an appropriate unsigned Boolean matrix, <span id="eq-primal1"><span class="math display">\[
\mathbf{v} = \mathbf{L}\mathbf{v}_C.
\tag{9}\]</span></span> The condition of continuity is then given by, <span class="math display">\[
\mathbf{B} \mathbf{L}\mathbf{v}_C = \mathbf{0}.
\]</span> Note that the above is satisfied irrespective of <span class="math inline">\(\mathbf{v}_C\)</span>, hence <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{L}\)</span> represent the null space of one another. This can provide a convenient way of obtaining one Boolean matrix from the other.</p>
<p>Substituting <a href="#eq-primal1" class="quarto-xref">Equation&nbsp;9</a> into <a href="#eq-3F1" class="quarto-xref">Equation&nbsp;6</a> (representing the uncoupled equation of motion) enforces continuity and yields, <span id="eq-primal2"><span class="math display">\[
\mathbf{Z}\mathbf{L}\mathbf{v}_C = \mathbf{f} + \mathbf{g}.
\tag{10}\]</span></span> Pre-multiplying both sides of <a href="#eq-primal2" class="quarto-xref">Equation&nbsp;10</a> by <span class="math inline">\(\mathbf{L}^{\rm T}\)</span> we obtain, <span id="eq-primal3"><span class="math display">\[
\mathbf{L}^{\rm T}\mathbf{Z}\mathbf{L}\mathbf{v}_C = \mathbf{L}^{\rm T}\mathbf{f} + \mathbf{L}^{\rm T}\mathbf{g}.
\tag{11}\]</span></span> Noting <a href="#eq-3F3" class="quarto-xref">Equation&nbsp;8</a> it is clear that the condition of equilibrium has now also been satisfied. Pre-multiplying both sides of <a href="#eq-primal3" class="quarto-xref">Equation&nbsp;11</a> by the inverse of the left most bracketed term yields, <span id="eq-primal4"><span class="math display">\[
\mathbf{v}_C = \left(\mathbf{L}^{\rm T}\mathbf{Z}\mathbf{L}\right)^{-1}\mathbf{f}_C
\tag{12}\]</span></span> where <span class="math inline">\(\mathbf{f}_C = \mathbf{L}^{T} \mathbf{f}\)</span> represents the external force applied to the coupled assembly, i.e.&nbsp;the sum of external forces acting on each sub-structure. Finally, substituting the block diagonal impedance matrix for the inverse mobility matrix, <span class="math display">\[
\mathbf{Z} = \mathbf{Y}^{-1}, \quad \quad \left[\begin{array}{c c c c}
\mathbf{Z}^{(1)} &amp; &amp; &amp;\\
&amp;  \mathbf{Z}^{(2)} &amp; &amp;\\
&amp; &amp; \mathbf{\ddots} &amp;\\
&amp; &amp; &amp; \mathbf{Z}^{(P)}
\end{array}\right] = \left[\begin{array}{c c c c}
\mathbf{Y}^{(1)} &amp; &amp; &amp;\\
&amp;  \mathbf{Y}^{(2)} &amp; &amp;\\
&amp; &amp; \mathbf{\ddots} &amp;\\
&amp; &amp; &amp; \mathbf{Y}^{(P)}
\end{array}\right]^{-1}
\]</span> where <span class="math inline">\(\mathbf{Y}^{(P)}\)</span> is the free mobility of the <span class="math inline">\(P\)</span>th component, we arrive at, <span id="eq-primal5"><span class="math display">\[
\mathbf{Y}_{C} = \left(\mathbf{L}^{\rm T}\mathbf{Y}^{-1}\mathbf{L}\right)^{-1}.
\tag{13}\]</span></span> where <span class="math inline">\(\mathbf{Y}_{C}\)</span> is the mobility of the coupled assembly.</p>
<p><a href="#eq-primal5" class="quarto-xref">Equation&nbsp;13</a> provides a general framework for determining the FRF matrix (in its entirety) of a coupled assembly. It can be interpreted as a generalisation of the impedance summation obtained by the direct method, as in equation <a href="#eq-directPoint" class="quarto-xref">Equation&nbsp;5</a>. In an experimental context <a href="#eq-primal5" class="quarto-xref">Equation&nbsp;13</a> has the downside of requiring several matrix inversions (each block matrix of <span class="math inline">\(\mathbf{Y}\)</span> must be inverted in full). These are not only computationally expensive, but prone to error amplification. For this reason, the primal formulation tends to be considered less reliable than its dual counterpart (discussed below). Nevertheless, for relatively small systems of equations, negligible differences are observed.</p>
</section>
<section id="dual" class="level3">
<h3 class="anchored" data-anchor-id="dual">Dual</h3>
<p>The dual formulation begins by satisfying the condition of equilibrium <em>a priori</em>. This is done by defining the coupling force <span class="math inline">\(\mathbf{g}\)</span> in the form, <span id="eq-dual1"><span class="math display">\[
\mathbf{g} = -\mathbf{B}^{\rm T}\mathbf{\lambda}
\tag{14}\]</span></span> where <span class="math inline">\(\mathbf{B}\)</span> is the same signed Boolean matrix introduced earlier, and <span class="math inline">\(\lambda\)</span> a Lagrange multiplier representing physically the unknown coupling interface force intensities. <span class="math inline">\(\lambda\)</span> is termed a force intensity as it possess no directional information. This is allocated by the Boolean matrix <span class="math inline">\(\mathbf{B}\)</span>.</p>
<p>The signed nature of <span class="math inline">\(\mathbf{B}\)</span> ensures collocated force intensities are equal and opposite in direction. The condition of equilibrium is then given by, <span class="math display">\[
\mathbf{L}^{\rm T}\mathbf{g} = -\mathbf{L}^{\rm T}\mathbf{B}^{\rm T}\mathbf{\lambda}  =  \mathbf{0}.
\]</span> Recalling that <span class="math inline">\(\mathbf{L}^{\rm T}\)</span>, the Boolean matrix satisfying equilibrium as per <a href="#eq-3F3" class="quarto-xref">Equation&nbsp;8</a>, is in the null space of <span class="math inline">\(\mathbf{B}^{\rm T}\)</span>, the condition of equilibrium is always satisfied.</p>
<p>Substituting <a href="#eq-dual1" class="quarto-xref">Equation&nbsp;14</a> into <a href="#eq-3F1" class="quarto-xref">Equation&nbsp;6</a> the equations of motion become, <span id="eq-dual2"><span class="math display">\[
\mathbf{v} = \mathbf{Y}\left(\mathbf{f} -\mathbf{B}^{\rm T}\lambda \right)
\tag{15}\]</span></span> where <span class="math inline">\(\mathbf{Y}\)</span> again represents the block diagonal matrix of component free mobilties, <span class="math display">\[
\mathbf{Y} = \left[\begin{array}{c c c c}
\mathbf{Y}^{(1)} &amp; &amp; &amp;\\
&amp;  \mathbf{Y}^{(2)} &amp; &amp;\\
&amp; &amp; \mathbf{\ddots} &amp;\\
&amp; &amp; &amp; \mathbf{Y}^{(P)}
\end{array}\right].
\]</span></p>
<p>To determine the coupled assembly response, we must first find <span class="math inline">\(\lambda\)</span>. To do so we begin by substituting <a href="#eq-dual2" class="quarto-xref">Equation&nbsp;15</a> into the continuity condition (see <a href="#eq-contin" class="quarto-xref">Equation&nbsp;2</a>), <span class="math display">\[
\mathbf{B}\mathbf{Y}\left(\mathbf{f} -\mathbf{B}^{\rm T}\lambda \right) =\mathbf{B}\mathbf{Y}\mathbf{f} - \mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\lambda = \mathbf{0}.
\]</span> In this sense, <span class="math inline">\(\lambda\)</span> can be interpreted as the force intensity required to ensure compatibility between connected DoFs. Rearranging the above to find <span class="math inline">\(\lambda\)</span>, <span class="math display">\[
\lambda = \left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\right)^{-1}\mathbf{B}\mathbf{Y}\mathbf{f}
\]</span> and substituting this into <a href="#eq-dual2" class="quarto-xref">Equation&nbsp;15</a> yields the coupled response (since continuity has now be enforced), <span class="math display">\[
\mathbf{v}_C = \mathbf{Y}\left(\mathbf{f} -\mathbf{B}^{\rm T}\left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\right)^{-1}\mathbf{B}\mathbf{Y}\mathbf{f}    \right) =  \left(\mathbf{Y} -\mathbf{Y}\mathbf{B}^{\rm T}\left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\right)^{-1}\mathbf{B}\mathbf{Y}   \right)\mathbf{f}.
\]</span> From the above we can identify the coupled mobility <span class="math inline">\(\mathbf{Y}_C\)</span> as, <span id="eq-dual3"><span class="math display">\[
\mathbf{Y}_C =   \mathbf{Y} -\mathbf{Y}\mathbf{B}^{\rm T}\left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\right)^{-1}\mathbf{B}\mathbf{Y}.  
\tag{16}\]</span></span></p>
<p><a href="#eq-dual3" class="quarto-xref">Equation&nbsp;16</a> is a little less intuitive than <a href="#eq-primal5" class="quarto-xref">Equation&nbsp;13</a>, so it is worth unpacking it a bit more. <span id="eq-dual4"><span class="math display">\[
\mathbf{v}_C =   \underbrace{\mathbf{Y}\mathbf{f}}_{\mathbf{v}}-\overbrace{\mathbf{Y}\underbrace{\mathbf{B}^{\rm T}\overbrace{\left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\right)^{-1}\underbrace{\mathbf{B}\mathbf{Y}\mathbf{f}}_{\Delta \mathbf{v}}}^{\lambda}}_{\mathbf{g}}}^{\mathbf{v}_g}
\tag{17}\]</span></span></p>
<p>As illustrated in <a href="#eq-dual4" class="quarto-xref">Equation&nbsp;17</a>, the left most <span class="math inline">\(\mathbf{Y}\mathbf{f}\)</span> term describes the response of each component to the applied force whilst uncoupled; being uncoupled, forces only generate responses within the component to which they are applied. The secondary term, <span class="math inline">\(\mathbf{Y}\mathbf{B}^{\rm T}\left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\right)^{-1}\mathbf{B}\mathbf{Y}\mathbf{f}\)</span> describes the additional contribution <span class="math inline">\(\mathbf{v}_g\)</span> to this response that arises due to the coupling forces <span class="math inline">\(\mathbf{g}\)</span> generated by the connected components. It is through this term that forces applied to one component generate responses in others. Breaking down this second term in detail, starting from the right, <span class="math inline">\(\mathbf{Y}\mathbf{f}\)</span> is again the free response of the uncoupled components due to the applied force <span class="math inline">\(\mathbf{f}\)</span>, and so pre-multiplication by <span class="math inline">\(\mathbf{B}\)</span> yields the velocity between the coupling DoFs, <span class="math inline">\(\Delta \mathbf{v}\)</span>. The product <span class="math inline">\(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\)</span> when expanded simply yields the sum of the coupling interface FRFs, and so pre-multiplication by the inverse term <span class="math inline">\(\left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T}\right)^{-1}\)</span> yields the coupling force intensity (see equation <span class="math inline">\(\ref{contFfreeV}\)</span>). This force is applied to the connecting components with equal magnitude but in opposite directions by <span class="math inline">\(\mathbf{B}^{\rm T}\)</span>, before being propagated through each component by <span class="math inline">\(\mathbf{Y}\)</span>, whereupon its contribution is combined with that of the force applied directly to the component.</p>
<p>Like <a href="#eq-primal5" class="quarto-xref">Equation&nbsp;13</a>, <a href="#eq-dual3" class="quarto-xref">Equation&nbsp;16</a> provides a general method for determining the mobility matrix of a coupled assembly. Note that in contrast to the primal formulation, the dual formulation requires only a single matrix inversion. Furthermore, after pre- and post-multiplication by <span class="math inline">\(\mathbf{B}\)</span> (and <span class="math inline">\(\mathbf{B}^{\rm T}\)</span>) the size of the required inversion is reduced to those of the interface DoFs alone. Hence, the dual formulation is a) computationally more efficient, and b) less prone to error amplification.</p>
<p>It is important to note that in deriving <a href="#eq-dual3" class="quarto-xref">Equation&nbsp;16</a> we did not define a unique set of assembly DoFs. And so in the dual formulation <span class="math inline">\(\mathbf{Y}_C\)</span> retains all uncoupled DoFs (interface DoFs are present twice). Care should be take to remove/avoid these duplicate rows and columns if necessary.</p>
</section>
<section id="including-resilient-coupling" class="level3">
<h3 class="anchored" data-anchor-id="including-resilient-coupling">Including resilient coupling</h3>
<p>The inclusion of resilient elements, such as vibration isolators, in a substructuring procedure is generally straight forward; the coupling element impedance matrix <span class="math inline">\(\mathbf{Z}_I\)</span> is simply included in the primal formulation as an individual substructure, or for the dual formulation its mobility matrix <span class="math inline">\(\mathbf{Y}_I\)</span>. However, in the case of ideal springs, the coupling element’s mobility matrix <span class="math inline">\(\mathbf{Y}_I\)</span> does not exist and so an alternative approach is required as described in the following.</p>
<p>Let us consider the simplest resilient coupling, that of an ideal spring-damper. The impedance matrix of such an element is given by, <span class="math display">\[
\mathbf{Z}_I = \left[\begin{array}{c c}
\frac{K}{i\omega}+C &amp; -(\frac{K}{i\omega}+ C) \\-(\frac{K}{i\omega}+ C) &amp; \frac{K}{i\omega}+ C
\end{array}\right]
\]</span> where <span class="math inline">\(K\)</span> is the stiffness of the spring, and <span class="math inline">\(C\)</span> is damping (assumed here to be of viscous type). An element of this form can be substituted directly in to the primal formulation as the equilibrium and continuity constraints are applied to the impedance matrices of each sub-structure (see <a href="#eq-primal4" class="quarto-xref">Equation&nbsp;12</a>). In contrast, the dual formulation requires the mobility matrix of each element (see <a href="#eq-dual3" class="quarto-xref">Equation&nbsp;16</a>), and so the coupling impedance must be inverted. Note however, that <span class="math inline">\(\mathbf{Z}_I\)</span> is singular. Its columns are linearly related by a factor of -1. Physically, this is because a force applied to an unconstrained, mass-less system causes an infinite response. Hence, an element impedance of this form is not compatible with the dual formulation as described above.</p>
<p>There are number of way to get around this apparent issue, two of which we will discuss here. The simplest approach is to add a small ‘virtual mass’ <span class="math inline">\(M\)</span> to either end of the ideal spring. By doing so the element’s impedance becomes, <span class="math display">\[
\mathbf{Z}_I = \left[\begin{array}{c c}
\frac{K}{i\omega}+C +i\omega M&amp; -(\frac{K}{i\omega}+ C) \\-(\frac{K}{i\omega}+ C) &amp; \frac{K}{i\omega}+C +i\omega M
\end{array}\right].
\]</span> Note that <span class="math inline">\(\mathbf{Z}_I\)</span> is no longer singular. It can be inverted to obtain the mobility <span class="math inline">\(\mathbf{Y}_I\)</span> and used within the dual formulation, though, care should be taken when adding this virtual mass. If it is made too large, noticeable effects will be introduced to the systems dynamics. The mass be chosen such that the local non-zero eigen frequencies of the coupling are at least 10 times greater than the frequency range of interest. Alternatively, the effect of the additional mass can be cancelled by coupling a second <em>negative virtual</em> mass to the assembly. This way the virtual mass can be chosen arbitrarily.</p>
<p>The second approach is to consider the resilient coupling as a relaxation of the continuity condition. That is, the connecting DoFs are no longer constrained to have the same velocity; the presence of a resilient element allows for their relative movement. We can then redefine an appropriate continuity condition as, <span class="math display">\[
\mathbf{B}\mathbf{v} =\mathbf{\delta} \neq \mathbf{0}
\]</span> where <span class="math inline">\(\mathbf{\delta}\)</span> represents the relative velocity of the two interface DoFs. In the presence of an ideal spring-like coupling, this relative velocity can be expressed in terms of the internal force generated by the spring-damper <span class="math inline">\(\lambda\)</span>, <span id="eq-dualRes"><span class="math display">\[\label{}
\mathbf{B}\mathbf{v} =\mathbf{\delta} = \boldsymbol{\Gamma}\lambda
\tag{18}\]</span></span> where <span class="math inline">\(\boldsymbol{\Gamma} = \mbox{diag}\left[\frac{K_1}{i\omega}+C_1,\cdots, \frac{K_N}{i\omega}+C_N\right]^{-1}\)</span> describes the inverse point impedance (i.e.&nbsp;mobility) of the <span class="math inline">\(N\)</span> coupling elements. Note that the condition of equilibrium is unchanged. This is because of the massless assumption of the spring-damper coupling, meaning force is conserved across it, and so <span class="math inline">\(\mathbf{g}_1 = \mathbf{g}_2\)</span>. Substituting <a href="#eq-dual2" class="quarto-xref">Equation&nbsp;15</a> into <a href="#eq-dualRes" class="quarto-xref">Equation&nbsp;18</a> we can rearrange to get <span class="math inline">\(\lambda\)</span>, <span id="eq-dualRes2"><span class="math display">\[
\lambda = \left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T} + \boldsymbol{\Gamma}\right)^{-1}\mathbf{B}\mathbf{Y}\mathbf{f}.
\tag{19}\]</span></span> Finally, substituting <a href="#eq-dualRes2" class="quarto-xref">Equation&nbsp;19</a> back into <a href="#eq-dual2" class="quarto-xref">Equation&nbsp;15</a>, we arrive at, <span id="eq-dualRes3"><span class="math display">\[
\mathbf{Y}_C =   \mathbf{Y} -\mathbf{Y}\mathbf{B}^{\rm T}\left(\mathbf{B}\mathbf{Y}\mathbf{B}^{\rm T} + \boldsymbol{\Gamma}\right)^{-1}\mathbf{B}\mathbf{Y}.  
\tag{20}\]</span></span> <a href="#eq-dualRes3" class="quarto-xref">Equation&nbsp;20</a> describes the mobility of a resiliently (spring-damper-like) coupled assembly, where <span class="math inline">\(\boldsymbol{\Gamma}\)</span> characterises the coupling element.</p>
<p>Note that the now permitted relative motion between the two sides of the coupling means that the dual method no longer produces duplicate rows/columns.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../introductions/isolators.html" class="pagination-link" aria-label="Vibration isolators">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Vibration isolators</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../introductions/blockedForce.html" class="pagination-link" aria-label="Blocked forces">
        <span class="nav-page-text">Blocked forces</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>