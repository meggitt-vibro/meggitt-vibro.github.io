<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Blocked forces â€“ Joshua Meggitt</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../introductions/uncertainty.html" rel="next">
<link href="../introductions/substructuring.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-045f01e90fa491bba6c51fbe92305c42.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Joshua Meggitt</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../introductions/introductions.html" aria-current="page"> 
<span class="menu-text">A quick introduction to:</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../papers/papers.html"> 
<span class="menu-text">Papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../book.html"> 
<span class="menu-text">Book</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="../mlsd.html">
 <span class="dropdown-text">Microphone and Loudspeaker Design</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../poav.html">
 <span class="dropdown-text">Principles of Acoustics and Vibration</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../introductions/blockedForce.html">Blocked forces</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/introductions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/VAVP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vibro-Acoustic Virtual Prototyping</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/components.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Components (passive characterisation)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/interfaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface representations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/isolators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vibration isolators</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/substructuring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Substructuring</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/blockedForce.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Blocked forces</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introductions/uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Uncertainty</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem-description" id="toc-problem-description" class="nav-link active" data-scroll-target="#problem-description">Problem description</a>
  <ul class="collapse">
  <li><a href="#source-characterisation" id="toc-source-characterisation" class="nav-link" data-scroll-target="#source-characterisation">Source characterisation</a></li>
  </ul></li>
  <li><a href="#contact-force" id="toc-contact-force" class="nav-link" data-scroll-target="#contact-force">Contact force</a></li>
  <li><a href="#blocked-force" id="toc-blocked-force" class="nav-link" data-scroll-target="#blocked-force">Blocked force</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition">Definition</a></li>
  <li><a href="#in-situ-measurement-of-blocked-force" id="toc-in-situ-measurement-of-blocked-force" class="nav-link" data-scroll-target="#in-situ-measurement-of-blocked-force">In situ measurement of blocked force</a></li>
  <li><a href="#a-nice-simple-proof" id="toc-a-nice-simple-proof" class="nav-link" data-scroll-target="#a-nice-simple-proof">A nice simple proof</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation">Validation</a></li>
  </ul></li>
  <li><a href="#what-next" id="toc-what-next" class="nav-link" data-scroll-target="#what-next">What next?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Blocked forces</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>On this page we introduce the <em>blocked force</em>; the most widely accepted means of characterisng the activity of vibration sources for use within a VAVP.</p>
<section id="problem-description" class="level2">
<h2 class="anchored" data-anchor-id="problem-description">Problem description</h2>
<p>A complex structure (say a vehcile, building, ship or air-craft) whose wave propagation characteristics are described by the function <span class="math inline">\(G(\quad)\)</span> is excited by a set of discrete forces <span class="math inline">\(\mathbf{f}_i\)</span> and distributed pressures <span class="math inline">\(p(x)\)</span> which arise due to internal operating mechanisms and external loading (e.g.&nbsp;turbulence), respectively. These forces induce a vibration which propagates through the structure; where upon reaching the position <span class="math inline">\(b\)</span> is observed as a structural velocity, say in the <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> directions, <span class="math inline">\(\mathbf{v}_r = \left[\begin{array}{ccc} v_{r,x} &amp; v_{r,y} &amp; v_{r,z}\end{array}\right]^{\mathrm T}\)</span>, or perhaps an acoustic response <span class="math inline">\(p_r\)</span>.</p>
<div id="fig-intForce" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intForce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SR.png" class="img-fluid figure-img" width="500">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intForce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Source-receiver model for structure-borne problems. <span class="math inline">\(\mathbf{f}_i\)</span> are the internal forces generated by any moving mechanisms, <span class="math inline">\(p(r)\)</span> is the external pressure loading, <span class="math inline">\(c\)</span> are the interface connection points between source and receiver, <span class="math inline">\(r\)</span> are a set of target points within the receiver structure and <span class="math inline">\(b\)</span> are a set of additiona DoFs used later for in direct estimation of the blocked force.
</figcaption>
</figure>
</div>
<p>In equation form we have that, <span class="math display">\[\begin{equation}
    \mathbf{v}_r = G(\mathbf{f}_i, p(x)).
\end{equation}\]</span></p>
<p>If we assume linearity and time invariance, this problem can be expressed conveniently in the frequency domain in terms of the assemblyâ€™s frequency response functions (FRFs), <span class="math display">\[\begin{equation}
     \mathbf{v}_r(\omega) = \overbrace{\mathbf{Y}_{Cri}(\omega)\mathbf{f}_i(\omega)}^{\mbox{Discrete forcing}} + \overbrace{\int_{\Omega S} Y_C(r|x_0) p(x_0) {\mathrm d} S}^{\mbox{ Continuous forcing}}
\end{equation}\]</span> where <span class="math inline">\(\mathbf{Y}_{Cri}\)</span> is a matrix of mobilities relating the <em>discrete</em> forces <span class="math inline">\(\mathbf{f}_i\)</span> to the responses in <span class="math inline">\(\mathbf{v}_r\)</span>, <span class="math inline">\(Y_C(r|x_0)\)</span> is a continuous mobility function relating the force at position <span class="math inline">\(x_0\)</span> to the response <span class="math inline">\(\mathbf{v}_r\)</span> at position <span class="math inline">\(r\)</span>, <span class="math inline">\(\omega\)</span> is the radian frequency (omitted hereafter for brevity). The capitalised sub-script <span class="math inline">\(C\)</span> is used to denote that the mobility belongs to the assembly (i.e.&nbsp;with the vibration source attached to the receiver).</p>
<p>Whilst the above representation of the problem is perfectly admissible, it has some practical issues if the aim is to predict the response <span class="math inline">\(\mathbf{v}_r\)</span>. First, the internal forces and pressures <span class="math inline">\(\mathbf{f}_i\)</span> and <span class="math inline">\(p(x)\)</span> are generally unknown, or at least very difficult to determine. Second, the location of said internal forces might not be obvious, and so the corresponding FRFs are also challenging to define. A solution to this problem is to find an alternative description of the source activity that:</p>
<ol type="1">
<li>is able to physically represent the acting forces and pressures (i.e.&nbsp;induce the same vibration in the receiver structure),</li>
<li>whose positions are known and,</li>
<li>whose magnitudes can be determined practically.</li>
</ol>
<p>By combining an appropriate description of source activity with the passive transfer characteristics of the structure, the prediction of structure-borne sound, due to arbitrarily complex mechanisms, is made possible.</p>
<p>To tackle the above, and remain inkeeping with our VAVP framework, it is natural to consider the source of vibration as a <em>component</em>, as opposed to the set of internal forces <span class="math inline">\(\mathbf{f}_i\)</span> and external pressures <span class="math inline">\(p(x)\)</span>. We can therefore represent the problem generally as in <a href="#fig-intForce" class="quarto-xref">Figure&nbsp;1</a>, where the vibration source component <span class="math inline">\(S\)</span> is attached to a receiver structure <span class="math inline">\(R\)</span> at the interface connection points labeled <span class="math inline">\(c\)</span>. These connections points are described by a number of <em>degrees of freedom</em> (DoFs), which represent the dynamics/motions in different directions. For <em>point-like</em> connections these DoFs are the translations in <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> and the rotation about each of these axis, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>.</p>
<p>Assuming the source and receiver components are coupled at a series of (approx.) discrete (point-like) connections, it is possible to simplify the problem by considering the forces that are occurring at the interface <span class="math inline">\(c\)</span>. Being both discrete and accessible, these interface forces provide an alternative means of representing the complex internal forces within the source. In a sense, the discrete interface between the source and receiver acts as a `â€™. Whilst the source-side excitation may be incredibly complex and applied over an extended area, as the induced receiver vibration is transmitted through the interface, only a reduced set of motions are possible. Assuming that each connection behaves in a point-like manner (i.e.&nbsp;is locally rigid), only 6 DoFs (three translations and three rotations) are permitted. Hence, for <span class="math inline">\(N\)</span> connection points, the response within the receiver can be represented entirely by <span class="math inline">\(6N\)</span> interface forces.</p>
<section id="source-characterisation" class="level3">
<h3 class="anchored" data-anchor-id="source-characterisation">Source characterisation</h3>
<p>When characterising a vibration source, particularly for the purpose of building a VAVP, it is essential that we obtain an <em>independent</em>â€™ characterisation. That is, a characterisation of the source that does not depend on the dynamics of the receiver. Doing so would allow for the same source characterisation to be used to predict the response of different receiver structures. There are two fundamental source descriptions that satisfy the required independence: the free velocity, and the blocked force. Whilst both the free velocity and the blocked force provide an independent characterisation, the free velocity is rarely used in practice. Indeed, it is the blocked force that has gained popularity in the last few years, so much so that an international standard has been devised for its (in direct) measurement.</p>
</section>
</section>
<section id="contact-force" class="level2">
<h2 class="anchored" data-anchor-id="contact-force">Contact force</h2>
<p>Whilst it is the blocked force that we are principally interested in (being an independent and transferable quantity), we will briefly introduce the so-called <em>contact force</em> as it is the more physically interpretable force and it will help provide some context to why the blocked is so important.</p>
<p>The contact force <span class="math inline">\(\mathbf{g}_c\)</span> describes the <em>physical forces</em> occurring at the interface between two connected components, e.g.&nbsp;a vibration source and receiver, when one or both are excited, as illustrated in <a href="#fig-contForce" class="quarto-xref">Figure&nbsp;2</a>.</p>
<div id="fig-contForce" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-contForce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SRcontactForce.png" class="img-fluid figure-img" width="500">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-contForce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Illustration of contact force.
</figcaption>
</figure>
</div>
<p>Being a <em>physical force</em>, the contact force can be measured directly, e.g.&nbsp;by inserting force transducers between the source and receiver components. It is not, however, an independent property of the source. That is, if the receiver component were modified or replaced, the contact force would change accordingly. If the contact force depends on the assembly in which the source is installed, it can not be transferred from a test bench to a simulation model. It is therefore of limited use in the context of Vibro-Acoustic Virtual Prototyping.</p>
</section>
<section id="blocked-force" class="level2">
<h2 class="anchored" data-anchor-id="blocked-force">Blocked force</h2>
<p>The blocked force is used almost universly when building VAVPs. It is an independent source quantity that can be obtained practically through an in direct method (detailed below).</p>
<section id="definition" class="level3">
<h3 class="anchored" data-anchor-id="definition">Definition</h3>
<p>The blocked force of a vibration source is the force required to rigidly constrain its interface degrees of freedom (DoFs) such that their velocity (also displacement and acceleration) is zero. Said another way, the blocked force is the reaction force presented by an infinitely rigid receiver structure when a connected vibration source operates. This notion is illustrated in <a href="#fig-blkF" class="quarto-xref">Figure&nbsp;3</a>.</p>
<div id="fig-blkF" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-blkF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="blkF.png" class="img-fluid figure-img" width="400">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-blkF-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Blocked force of a vibration source. The interface DoFs <span class="math inline">\(c\)</span> are rigidly constrained by the blocked force <span class="math inline">\(\mathbf{\bar{f}}_{c}\)</span>.
</figcaption>
</figure>
</div>
<p>Mathematically, we can define the blocked force as, <span class="math display">\[\begin{equation}
    \mathbf{\bar{f}}_{c} = \mathbf{{g}}_{c}\Big|_{\mathbf{v}_{c}=\mathbf{0}}
\end{equation}\]</span> where <span class="math inline">\(\mathbf{g}_{c}\)</span> is the contact force at the interface <span class="math inline">\(c\)</span> and <span class="math inline">\(\mathbf{v}_{c}=\mathbf{0}\)</span> is the rigid constraint. It is clear that by blocking the interface DoFs, the blocked force provides an independent source description. The influence of any receiver structure has been removed by constraining the interface DoFs. It is worth noting that the blocked force is a somewhat hypothetical force, it is defined by means of an <em>infinitely</em> rigid constraint which in practice can not be achieved.</p>
</section>
<section id="in-situ-measurement-of-blocked-force" class="level3">
<h3 class="anchored" data-anchor-id="in-situ-measurement-of-blocked-force">In situ measurement of blocked force</h3>
<p>To characterise the blocked force of a vibration source <em>directly</em> it is necessary to attach the source to an (approx.) infinitely rigid test bench, for example a large blocking mass, with force transducers placed between the source contacts and the test bench. Clearly, this `infinitely rigidâ€™ requirement can only be satisfied approximately over a particular frequency range; even the most rigid test bench will eventually enter a modal/flexible regime. Achieving a sufficiently rigid condition can be further complicated by the mounting requirements of the source. Another notable challenge involves the determination of rotational and in-plane blocked forces. Hence, the direct measurement of the blocked force is fraught with difficulties and generally not practical. Fortunately, an in direct measurement approach is available.</p>
<p>The direct method described above is focused on measuring force directly, by means of installed force transducers. The indirect approach involves the measurement of the assemblies operational response (e.g.&nbsp;velocity), from which we infer the unknown blocked force.</p>
<p>The key equation on which the indirect approach is based is given by, <span id="eq-EqBlkF"><span class="math display">\[  
\mathbf{v}_{b} = (-)\mathbf{Y}_{Cbc}\mathbf{\bar{f}}_{c}
\tag{1}\]</span></span> where <span class="math inline">\(\mathbf{v}_{b}\in\mathbb{C}^{N_b}\)</span> is the operational velocity (to be measured) of the structure at a set of â€˜indicatorâ€™ positions <span class="math inline">\(b\)</span>, <span class="math inline">\(\mathbf{Y}_{Cbc}\in\mathbb{C}^{N_b\times N_c}\)</span> is the transfer mobility of the assembled structure (also to be measured), and <span class="math inline">\(\mathbf{\bar{f}}_{c}\in\mathbb{C}^{N_c}\)</span> is the unknown blocked force. <a href="#eq-EqBlkF" class="quarto-xref">Equation&nbsp;1</a> provides a relation between the blocked force of a vibration source and the velocity of the assembly in which it is installed. Theoretically, <a href="#eq-EqBlkF" class="quarto-xref">Equation&nbsp;1</a> includes a negative sign, for reasons that will be explained shortly. However, this negative sign has no bearing on the in situ method itself as its simply a <span class="math inline">\(180^\circ\)</span> phase shift. For this reason, the negative sign is often let out of the equation, as we done hereafter.</p>
<p>Note that the indicator DoFs <span class="math inline">\(b\)</span> can be located at the interface <span class="math inline">\(c\)</span>, in which case <a href="#eq-EqBlkF" class="quarto-xref">Equation&nbsp;1</a> becomes, <span id="eq-EqBlkF1"><span class="math display">\[
    \mathbf{v}_{c} = \mathbf{Y}_{Ccc}\mathbf{\bar{f}}_{c}
\tag{2}\]</span></span> where <span class="math inline">\(\mathbf{v}_{c}\in\mathbb{C}^{N_b}\)</span> and <span class="math inline">\(\mathbf{Y}_{Ccc}\in\mathbb{C}^{N_c\times N_c}\)</span> are the operational velocity and point FRF matrix of the interface <span class="math inline">\(c\)</span>.</p>
<p>To determine the blocked force we have to solve the â€˜inverse problemâ€™. Pre-multiplication of both sides of <a href="#eq-EqBlkF" class="quarto-xref">Equation&nbsp;1</a> and <a href="#eq-EqBlkF1" class="quarto-xref">Equation&nbsp;2</a> by the inverse mobility matrix yields, <span id="eq-EqBlkF2"><span class="math display">\[
    \mathbf{\bar{f}}_{c} = \mathbf{Y}_{Cbc}^{-1}\mathbf{v}_{b} \quad \quad  \mbox{and} \quad \quad  \mathbf{\bar{f}}_{c} = \mathbf{Y}_{Ccc}^{-1}\mathbf{v}_{c}
\tag{3}\]</span></span> the latter of which is generally preferred as measurements made away from the interface <span class="math inline">\(c\)</span> are more easily corrupted, e.g.&nbsp;by external disturbances, etc. Alternatively, <a href="#eq-EqBlkF2" class="quarto-xref">Equation&nbsp;3</a> can be combined and written in a more general form, <span id="eq-EqBlkF4"><span class="math display">\[
    \mathbf{\bar{f}}_{c} = \left[\begin{array}{c}
        \mathbf{Y}_{Ccc}\\
        \mathbf{Y}_{Cbc}
    \end{array}\right]^+
     \left(\begin{array}{c}
        \mathbf{v}_{c}\\
        \mathbf{v}_{b}
    \end{array}\right) = \mathbf{Y}_C^+\mathbf{v}
\tag{4}\]</span></span> where <span class="math inline">\(\square^+\)</span> denotes the matrix pseduo-inverse.</p>
<p>To solve <a href="#eq-EqBlkF4" class="quarto-xref">Equation&nbsp;4</a>, it is necessary that number of measured velocities (<span class="math inline">\(M\)</span>) is equal to, or greater than, the number of blocked forces that are being determined. That is, to determine <span class="math inline">\(N\)</span> blocked forces, <span class="math inline">\(M\geq N\)</span> velocities should be recorded. The dimensions of the mobility matrix <span class="math inline">\(\mathbf{Y}_{C}\)</span> should be consistent with those of the blocked force and velocity vectors, it should be <span class="math inline">\(M\times N\)</span>. The number of recorded velocities relative to the number of blocked forces will be discussed further in a later section.</p>
<div id="fig-SRblockedForce" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SRblockedForce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="SRblockedForce.png" class="img-fluid figure-img" width="500">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SRblockedForce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Illustration of blocked force as an equivalent force. The response generated within the domain of <span class="math inline">\(R\)</span> due to the applied (negative) blocked force (whilst source is inactive) is identical to that generated by the internal forces and pressures in <a href="#fig-blkF" class="quarto-xref">Figure&nbsp;3</a> (i.e.&nbsp;when the source is active).
</figcaption>
</figure>
</div>
<p>Importantly, <a href="#eq-EqBlkF4" class="quarto-xref">Equation&nbsp;4</a> provides a means of determining the blocked force <em>without requiring an infinitely rigid test bench</em>. In fact, no restrictions are placed on the assembly <span class="math inline">\(C\)</span> in which the source is installed. As such, <a href="#eq-EqBlkF4" class="quarto-xref">Equation&nbsp;4</a> enables an <em>in situ</em> characterisation of the blocked force; the source need not be removed from its intended installation. It thus provides a practical source characterisation method.</p>
<p>The experimental implementation of the in situ approach follows a two part measurement procedure:</p>
<ol type="1">
<li>The source is turned off and the mobility matrix <span class="math inline">\(\mathbf{Y}_{Cbc}\)</span> is measured between the interface and indicator DoFs. This is typically done by applying a known force to each interface DoF (using an instrumented force hammer or a roving shaker) whilst simultaneously measuring the response at all indicator DoFs (typically using accelerometers). Note that if the interface DoFs are not accessible for excitation the principle of reciprocity can be used to interchange the excitation and response positions, <span class="math inline">\(\mathbf{Y}_{Cbc} = \mathbf{Y}_{Ccb}^{\rm T}\)</span>.</li>
<li>The source is turned on and the operational velocity <span class="math inline">\(\mathbf{v}_{b}\)</span> is measured at the indicator DoFs. This is typically done using the same set of response sensors as used in part 1.</li>
</ol>
<p>Before conducting part two of the above procedure, it is generally good practice to perform a number of data checks to a) inspect the quality of the measured mobility matrix, and b) ensure sufficient number of DoFs have been accounted for (i.e.&nbsp;the interface is complete).</p>
</section>
<section id="a-nice-simple-proof" class="level3">
<h3 class="anchored" data-anchor-id="a-nice-simple-proof">A nice simple proof</h3>
<p>Here we present a simple â€˜equation freeâ€™ proof of the in situ blocked force relation in <a href="#eq-EqBlkF1" class="quarto-xref">Equation&nbsp;2</a> by considering the principle of linear superposition as illustrated in <a href="#fig-blkFproof" class="quarto-xref">Figure&nbsp;5</a>. More mathematical proofs are available in the literature.</p>
<div id="fig-blkFproof" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-blkFproof-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-blkFproof" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-blkFproof_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-blkFproof_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="blkFproof.png" class="img-fluid figure-img" style="width:80.0%" data-ref-parent="fig-blkFproof">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-blkFproof_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Whilst internal forces are active an external force is applied to the interface which constrains its response to 0.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-blkFproof" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-blkFproof_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-blkFproof_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="blkFproof2.png" class="img-fluid figure-img" style="width:80.0%" data-ref-parent="fig-blkFproof">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-blkFproof_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Whilst internal forces are inactive the external force is reversed and response field is reproduced.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-blkFproof-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: In situ blocked force proof based on principle of superposition.
</figcaption>
</figure>
</div>
<p>Consider the vibration source to be active. The internal and boundary forces (<span class="math inline">\(\mathbf{f}_i\)</span> and <span class="math inline">\(p(x)\)</span>) generate a response field <span class="math inline">\(v_i\)</span> within the reciever domain <span class="math inline">\(R\)</span>. An external (blocking) force is then applied across the interface DoFs <span class="math inline">\(c\)</span> that rigidly constrains its motion. With the interface DoFs now fixed, no vibration can be transmitted into the recevier, and so its response is 0 at all positions. An alterntive interpretation is that the external blocking force generates a secondary wave field <span class="math inline">\(v_c\)</span> in the receiver that is equal in magnitude, but opposite in phase to the original wave field such that their sum is zero (<span class="math inline">\(v_R = v_i + v_c = 0\)</span>).</p>
<p>If these forces are applied at the interface so as to nullify the interface response, and the machine is then switched off, as in <a href="#fig-blkFproof_2" class="quarto-xref">Figure&nbsp;5 (b)</a>, we are left with a response field that must be simply the reverse of the original field <span class="math inline">\(v_c = -v_i\)</span>. Simply reversing the sign we conclude that *the response field within the receiver can be reproduced identically by applying the negative blocking forces to the interface<span class="math inline">\(, or in equation form,\)</span>$<br>
<em>{r} = (-)</em>{Crc}_{c} $$ for any DoFs <span class="math inline">\(r\)</span> within the receiver.</p>
</section>
<section id="validation" class="level3">
<h3 class="anchored" data-anchor-id="validation">Validation</h3>
<p>Before the blocked force can be used within a VAVP, it is essential that some sort of validation is performed to give us confidence that a <em>correct</em> identification has been acheived. This can be done in various ways, though the most common is by what is termed an <em>on-board validation</em>.</p>
<section id="on-board-validation" class="level4">
<h4 class="anchored" data-anchor-id="on-board-validation">On-board validation</h4>
<p>This validation is pretty simple. During the characterisation of the blocked force, one or more of the remote <span class="math inline">\(b\)</span> DoFs are ommitted from the inverse calculation (i.e. <a href="#eq-EqBlkF4" class="quarto-xref">Equation&nbsp;4</a>). After the blocked force has been obtained, a forward response prediction is made for the as yet unused <span class="math inline">\(b\)</span> DoFs, denoted <span class="math inline">\(\tilde{b}\)</span> here, <span id="eq-EqBlkF_obVal"><span class="math display">\[  
\mathbf{v}_{\tilde{b}} = \mathbf{Y}_{C\tilde{b}c}\mathbf{\bar{f}}_{c}
\tag{5}\]</span></span> where it should be made clear that both <span class="math inline">\(\mathbf{v}_{\tilde{b}}\)</span> and <span class="math inline">\(\mathbf{Y}_{C\tilde{b}c}\)</span> are measured during the initial measurement campaign (i.e.&nbsp;simultaneous to those used in the characterisation). An on-board validation then amounts to a comparision of the predicted and directly measured responses <span class="math inline">\(\mathbf{v}_{\tilde{b}}\)</span>. This comparision can be done in anyway the user prefers, e.g.&nbsp;by a mean squares error or a correlation-based metric (e.g.&nbsp;MAC), though is most commonly done simply by visual inspection, i.e.&nbsp;plotting measured and predicted responses together.</p>
</section>
<section id="modified-reciever-validation" class="level4">
<h4 class="anchored" data-anchor-id="modified-reciever-validation">Modified reciever validation</h4>
<p>The on-board validation procedure described above, though convenient and an important step in critiquing the blocked force, is not the most robust form of validation. Indeed, one could obtain an excellent on-board validation, but get terrible agreement once the blocked force is transfered to a VAVP. In other words, since the charactrisation and validation assemblies share the same dynamics, some potential errors might not come to light. For this reason, a more robust validation is to predict into a <em>different</em> assembly.</p>
<p>The most convenient way of doing this is to introduce a structural modification onto the recevier structure used for the initial characterisation, thus altering its dynamics and forming a <em>new assembly</em>, <span class="math inline">\(C\rightarrow \tilde{C}\)</span>. A validation is then obtained by 1) running the source on this modified recevier, 2) remeasuring its coupled FRF <span class="math inline">\(\mathbf{Y}_{\tilde{C}bc}\)</span> (note that all <span class="math inline">\(b\)</span> DoFs can now be used since we are effectivly using a new assembly), 3) recording the operational response <span class="math inline">\(v_b\)</span>, 4) and using the blocked force from assembly <span class="math inline">\(C\)</span> to predict the response in <span class="math inline">\(\tilde{C}\)</span>, <span class="math display">\[  
\mathbf{v}_{b} = \mathbf{Y}_{\tilde{C}bc}\mathbf{\bar{f}}_{c}
\]</span> Again, comparison of predicted and measured responses gives an idea of the predictive accuracy of the aquired blocked forces. Of course, additional validation steps are recommended when building a full VAVP (including transferability and substructuring vsalidations), though these are not addressed here.</p>
</section>
</section>
</section>
<section id="what-next" class="level2">
<h2 class="anchored" data-anchor-id="what-next">What next?</h2>
<p>We now have everything we need to build a VAVP: methods for characterising the passive properties of vibration sources, receiver structures and coupling elements; a means of coupling these components together to build an assembly; and a method of characterising the active properties of vibration sources by their blocked forces, thus allowing us to â€˜turn onâ€™ our VAVP. All thats left to do is put it all together. In summary, the steps to build a VAVP are:</p>
<ol type="1">
<li>Characterise the vibration source by first freely suspending it (e.g.&nbsp;hang from resilient bungees) and measure its free-interface FRF matrix <span class="math inline">\(\mathbf{Y}_S\)</span>. Next, instal the source onto some test bench and characterise the blocked force <span class="math inline">\(\mathbf{\bar{f}}\)</span> using the in situ method. This completes the source characterisation.</li>
<li>Measure (or model) the free-interface FRF of the receviering structure to obtain <span class="math inline">\(\mathbf{Y}_R\)</span>, and <span class="math inline">\(\mathbf{H}_R\)</span> if acoustic responses are of interest.</li>
<li>If the source and receiver are to be resiliently coupled, characterise the chosen isolator(s) by first installing it between two simple components (e.g.&nbsp;two masses) and then using in situ method with either force conservation or decoupling. Repeat this process to obtain an isolator FRF matrix <span class="math inline">\(\mathbf{Y}_I\)</span> for each coupling element. (Note that a model could also be used to characterise the element)</li>
<li>Couple the components together using substructuring to build a model of the assembly <span class="math inline">\(\mathbf{Y}_C\)</span> (<span class="math inline">\(\mathbf{H}_C\)</span>).</li>
<li>Finally, apply the blocked force obtained from step 1. to the substructured FRF obtained from step 4. to make a response prediction for the VAVP.</li>
</ol>
<p>Though not an essential step when building a VAVP, it is good practice whenever building any type of model to develop some understanding of the errors involved. It should be obvious that a VAVP prediction with an accompanying confidence bound is far more valuable than one withoutâ€¦ Thus, the final topic we will discuss is that of <a href="../introductions/uncertainty.html">Uncertainties</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../introductions/substructuring.html" class="pagination-link" aria-label="Substructuring">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Substructuring</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../introductions/uncertainty.html" class="pagination-link" aria-label="Uncertainty">
        <span class="nav-page-text">Uncertainty</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>